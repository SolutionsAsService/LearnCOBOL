IDENTIFICATION DIVISION.
PROGRAM-ID. BusinessBudgetManagement.

ENVIRONMENT DIVISION.
INPUT-OUTPUT SECTION.
FILE-CONTROL.

DATA DIVISION.
FILE SECTION.

WORKING-STORAGE SECTION.
01 BUSINESS-BUDGET.
   05 ANNUAL-REVENUE          PIC 9(9)v99.
   05 TOTAL-EXPENSES          PIC 9(9)v99.
   05 NET-INCOME              PIC 9(9)v99.

01 EXPENSE-CATEGORIES.
   05 SALARIES-EXPENSE        PIC 9(9)v99.
   05 OPERATING-EXPENSE       PIC 9(9)v99.
   05 MARKETING-EXPENSE       PIC 9(9)v99.
   05 MISCELLANEOUS-EXPENSE   PIC 9(9)v99.

01 CATEGORY-CODE              PIC X.
    88 SALARIES-CODE          VALUE 'S'.
    88 OPERATING-CODE         VALUE 'O'.
    88 MARKETING-CODE         VALUE 'M'.
    88 MISCELLANEOUS-CODE     VALUE 'E'.
    88 DONE-CODE              VALUE 'D'.

01 EXPENSE-AMOUNT             PIC 9(9)v99.

PROCEDURE DIVISION.
START-PROGRAM.
    DISPLAY "Enter Expected Annual Revenue: $"
    ACCEPT ANNUAL-REVENUE

    PERFORM INITIALIZE-EXPENSES
    PERFORM COLLECT-EXPENSES UNTIL DONE-CODE
    COMPUTE TOTAL-EXPENSES = SALARIES-EXPENSE + OPERATING-EXPENSE + 
                             MARKETING-EXPENSE + MISCELLANEOUS-EXPENSE
    COMPUTE NET-INCOME = ANNUAL-REVENUE - TOTAL-EXPENSES

    DISPLAY "Total Expenses: $" TOTAL-EXPENSES
    DISPLAY "Net Income: $" NET-INCOME
    STOP RUN.

INITIALIZE-EXPENSES.
    MOVE 0 TO SALARIES-EXPENSE
    MOVE 0 TO OPERATING-EXPENSE
    MOVE 0 TO MARKETING-EXPENSE
    MOVE 0 TO MISCELLANEOUS-EXPENSE.

COLLECT-EXPENSES.
    DISPLAY "Enter Expense Category (S=Salaries, O=Operating, M=Marketing, E=Miscellaneous, D=Done): "
    ACCEPT CATEGORY-CODE
    IF NOT DONE-CODE
        DISPLAY "Enter Expense Amount: $"
        ACCEPT EXPENSE-AMOUNT
        EVALUATE CATEGORY-CODE
            WHEN SALARIES-CODE
                ADD EXPENSE-AMOUNT TO SALARIES-EXPENSE
            WHEN OPERATING-CODE
                ADD EXPENSE-AMOUNT TO OPERATING-EXPENSE
            WHEN MARKETING-CODE
                ADD EXPENSE-AMOUNT TO MARKETING-EXPENSE
            WHEN MISCELLANEOUS-CODE
                ADD EXPENSE-AMOUNT TO MISCELLANEOUS-EXPENSE
        END-EVALUATE.

END PROGRAM BusinessBudgetManagement.
